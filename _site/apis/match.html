<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Amida Blue Button Docs</title>

    <!-- Bootstrap -->
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

	<!-- CDN http://cdnjs.com/libraries/highlight.js/ -->
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/styles/tomorrow.min.css">

    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/highlight.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/languages/javascript.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/languages/json.min.js"></script>
    <script>
    hljs.initHighlightingOnLoad();
    </script>


  	<style>


/*
 * Base structure
 */

/* Move down content because we have a fixed navbar that is 50px tall */
body {
  padding-top: 50px;
}


/*
 * Global add-ons
 */

.sub-header {
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
}

/*
 * Top navigation
 * Hide default border to remove 1px line.
 */
.navbar-fixed-top {
  border: 0;
}

/*
 * Sidebar
 */

/* Hide for mobile, show later */
.sidebar {
  display: none;
}
@media (min-width: 768px) {
  .sidebar {
    position: fixed;
    top: 51px;
    bottom: 0;
    left: 0;
    z-index: 1000;
    display: block;
    padding: 20px;
    overflow-x: hidden;
    overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
    /*background-color: #f5f5f5;*/
    border-right: 1px solid #eee;
  }
}

/* Sidebar navigation */
.nav-sidebar {
  margin-right: -21px; /* 20px padding + 1px border */
  margin-bottom: 20px;
  margin-left: -20px;
}
.nav-sidebar > li > a {
  padding-right: 20px;
  padding-left: 20px;
}
.nav-sidebar > .active > a,
.nav-sidebar > .active > a:hover,
.nav-sidebar > .active > a:focus {
  color: #fff;
  background-color: #428bca;
}


/*
 * Main content
 */

.main {
  padding: 20px;
}
@media (min-width: 768px) {
  .main {
    padding-right: 40px;
    padding-left: 40px;
  }
}
.main .page-header {
  margin-top: 0;
}



  	</style>
  </head>
  <body>

    <!-- Static navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/index.html">
		        <img style="max-width:100px; margin-top: -7px;"
		             src="http://www.amida-tech.com/assets/img/design/logo-retina.png">

		             &nbsp; Blue Button Docs</a>

        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/model.html">Data Model</a></li>
            <li><a href="/parsers.html">Parsers</a></li>
            <li><a href="/apis.html">APIs</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="../navbar-fixed-top/"> smth </a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>


    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">

                  <ul class="nav nav-sidebar">
                      
          </ul>

        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

<h1 id="blue-button-match">blue-button-match</h1>
<p>Automatic matching of Blue Button JSON data (detection of new, duplicate and partial match entries)</p>
<p><a href="https://nodei.co/npm/blue-button-match/"><img src="https://nodei.co/npm/blue-button-match.png" alt="NPM"></a></p>
<p><a href="https://travis-ci.org/amida-tech/blue-button-match"><img src="https://travis-ci.org/amida-tech/blue-button-match.svg" alt="Build Status"></a>
<a href="https://coveralls.io/r/amida-tech/blue-button-match"><img src="https://coveralls.io/repos/amida-tech/blue-button-match/badge.png" alt="Coverage Status"></a></p>
<h2 id="library-interfaces-apis">Library interfaces/APIs</h2>
<p>This library exposes methods for matching entire health records as well as lower level methods for matching sections of health records.</p>
<p>This library provides following functionality</p>
<ul>
<li>Match two health records in blue-button JSON format</li>
<li>Match individual sections of above</li>
</ul>
<h3 id="usage-example">Usage example</h3>
<p>Require blue-button-match module</p>
<pre><code class="lang-javascript">var match = require(&quot;./index.js&quot;) 
var bb = require(&quot;blue-button&quot;);

var recordA = bb.parseString(&quot;record A&quot;);
var recordB = bb.parseString(&quot;record B&quot;);

var result = match.match(recordA.data, recordB.data);

console.log(result);
</code></pre>
<p>This will produce match object looking like this:</p>
<pre><code class="lang-javascript">{
    &quot;match&quot;:
    {
        &quot;allergies&quot; : [
            { &quot;src_id&quot; : 0, &quot;dest_id&quot; : 0, &quot;match&quot;:&quot;duplicate&quot; },
            { &quot;src_id&quot; : 1, &quot;dest_id&quot; : 1, &quot;match&quot;:&quot;duplicate&quot; },
            { &quot;src_id&quot; : 2, &quot;dest_id&quot; : 2, &quot;match&quot;:&quot;duplicate&quot; },
            ...
            }
        ],
        &quot;medications&quot; : [...],
        &quot;demographics&quot; : [...]
        ...
    },
    &quot;meta&quot;:
    {
        &quot;version&quot; : &quot;0.0.1&quot;
    },
    &quot;errors&quot;: []
}
</code></pre>
<h4 id="matching-record-explanation">Matching record explanation</h4>
<p>Match element can be <code>{&quot;match&quot; : &quot;duplicate&quot;}</code>, <code>{&quot;match&quot; : &quot;new&quot;}</code> or <code>{&quot;match&quot; : &quot;partial&quot;, &quot;percent&quot;: 50}</code>, partial match is expressed in percents and can range from <code>1</code> to <code>99</code>. Element attribute <code>dest_id</code> refers to element position (index) in related section&#39;s array of master health record. Element attribute <code>src_id</code> refers to element position (index) in related array of document being merged (new record).</p>
<pre><code class="lang-javascript">{
    &quot;match&quot;:
    {
        &quot;allergies&quot; : [
            { &quot;match&quot; : &quot;duplicate&quot;, &quot;src_id&quot; : 0, &quot;dest_id&quot;: 2 },
            { &quot;match&quot; : &quot;new&quot;, &quot;src_id&quot; :1 },
            { &quot;match&quot; : &quot;partial&quot;, &quot;percent&quot; : 50, &quot;src_id&quot; : 2, &quot;dest_id&quot; : 5},
            ...
            }
        ],
        &quot;medications&quot; : [...],
        &quot;demographics&quot; : [...]
        ...
    }
}
</code></pre>
<h3 id="matching-results-json-structures-by-record-type-">Matching results JSON structures (by record type)</h3>
<h4 id="flat">Flat</h4>
<p><em>Applied to : Vital Signs, Medications, Problems, Immunizations, Procedures</em></p>
<pre><code class="lang-javascript">[
    { &quot;match&quot; : &quot;duplicate&quot;, &quot;src_id&quot; : 0, &quot;dest_id&quot;: 2 },
    { &quot;match&quot; : &quot;new&quot;, &quot;src_id&quot; :1 },
    { &quot;match&quot; : &quot;partial&quot;, &quot;percent&quot; : 50, &quot;src_id&quot; : 2, &quot;dest_id&quot; : 5},
    ...
    }
]
</code></pre>
<h4 id="containing-subarrays">Containing subarrays</h4>
<p><em>Applied to: Results, Allergies, Encounters</em></p>
<pre><code class="lang-javascript">[
    { &quot;match&quot; : &quot;new&quot;, &quot;src_id&quot; :1 }, //completely new element
    { &quot;match&quot; : &quot;duplicate&quot;, &quot;src_id&quot; : 0, &quot;dest_id&quot;: 2 }, //completely duplicate element

    { &quot;match&quot; : &quot;duplicate_new_subelements&quot;, &quot;src_id&quot; : 0, &quot;dest_id&quot;: 2 
        &quot;subelements&quot;: [
            { &quot;match&quot; : &quot;duplicate&quot;, &quot;src_id&quot; : 0, &quot;dest_id&quot;: 2 },
            { &quot;match&quot; : &quot;new&quot;, &quot;src_id&quot; :1 },
            { &quot;match&quot; : &quot;partial&quot;, &quot;percent&quot; : 50, &quot;src_id&quot; : 2, &quot;dest_id&quot; : 5},
            ...
            }
        ]

    }, //completely duplicate element but difference in subelements exists

    { &quot;match&quot; : &quot;partial&quot;, &quot;percent&quot; : 50, &quot;src_id&quot; : 2, &quot;dest_id&quot; : 5
        &quot;subelements&quot;: [
            { &quot;match&quot; : &quot;duplicate&quot;, &quot;src_id&quot; : 0, &quot;dest_id&quot;: 2 },
            { &quot;match&quot; : &quot;new&quot;, &quot;src_id&quot; :1 },
            { &quot;match&quot; : &quot;partial&quot;, &quot;percent&quot; : 50, &quot;src_id&quot; : 2, &quot;dest_id&quot; : 5},
            ...
            }
        ]
    }, 
    ...
    } //partial match
]
`
</code></pre>
<h4 id="single-facts">Single facts</h4>
<p><em>Applied to: Demographics, Social History</em></p>
<pre><code class="lang-javascript">//only one match element present
[
    { &quot;match&quot; : &quot;duplicate&quot;}, //record is complete duplicate
]
</code></pre>
<pre><code class="lang-javascript">//only one match element present
[
    { &quot;match&quot; : &quot;diff&quot;, 
        &quot;diff&quot;: {
            &quot;element_name_1&quot;:&quot;duplicate&quot;, //element is the same
            &quot;element_name_2&quot;:&quot;new&quot;, //element has new value
        }},
]
</code></pre>
<p>Edge cases for single facts:</p>
<p>Both objects are empty e.g. comparePartial({}, {})</p>
<pre><code class="lang-javascript">[ { match: &#39;duplicate&#39; } ]
</code></pre>
<p>Comparing empty object e.g. {} with non-empty (master record)</p>
<pre><code class="lang-javascript">[ { match: &#39;diff&#39;, diff: {} } ]
</code></pre>
<p>Comparing non empty object with empty master record {}</p>
<pre><code class="lang-javascript">[ { match: &#39;new&#39; } ]
</code></pre>
<h2 id="matching-rules">Matching Rules</h2>
<h4 id="common-matching-rules">Common matching rules</h4>
<p>Fuzzy date match - dates match with margin of errors; in case of date ranges, checked for overlap; margin of error is 24 hrs.</p>
<p>Code (Code System match) - code and code_system_name must match.</p>
<p>Code match with translations - codes (and code_system_names) between two entries should have at least one match.</p>
<h3 id="allergies">Allergies</h3>
<p>Code match on Allergen is required.</p>
<p>Date and Fuzzy date match.</p>
<h3 id="medications">Medications</h3>
<p>Code match with translation on Medication.</p>
<p>Status match.</p>
<p>Date and Fuzzy date match.</p>
<h3 id="problems">Problems</h3>
<p>Code match with translation on Medication is required.</p>
<p>Status match.</p>
<p>Negation indicator match.</p>
<p>Date and Fuzzy date match.</p>
<h3 id="results">Results</h3>
<p>Code match on Result is required.</p>
<p>Since Result doesn&#39;t have a date. Dates from sub results are collected for both entries. Fuzzy date match is used.</p>
<h3 id="demographics">Demographics</h3>
<p>All subelements are compared.</p>
<h3 id="procedures">Procedures</h3>
<p>Code match with translation on Procedure is required.</p>
<p>Status dismatch results in 0% match.</p>
<p>Date and Fuzzy date match.</p>
<h3 id="encounters">Encounters</h3>
<p>Code match with translation on Encounter is required.</p>
<p>Date and Fuzzy date match.</p>
<h3 id="immunizations">Immunizations</h3>
<p>Code match with translation on Immunization is required.</p>
<p>Status dismatch results in 0% match.</p>
<p>Date and Fuzzy date match.</p>
<h3 id="vitals-model">Vitals model</h3>
<p>Code match with translation on Vital Sign is required.</p>
<p>Date and Fuzzy date match.</p>
<h3 id="social-history">Social History</h3>
<p>All subelements are compared.</p>
<h2 id="contributing">Contributing</h2>
<p>Contributors are welcome. See issues <a href="https://github.com/amida-tech/blue-button-match/issues">https://github.com/amida-tech/blue-button-match/issues</a></p>
<h2 id="release-notes">Release Notes</h2>
<p>See release notes [here] (./RELEASENOTES.md)</p>
<h2 id="license">License</h2>
<p>Licensed under <a href="./LICENSE">Apache 2.0</a></p>

        </div>
      </div>
    </div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<!-- Latest compiled and minified JavaScript -->
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>