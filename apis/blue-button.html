<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Amida Developers</title>

    <!-- Bootstrap -->
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

	<!-- CDN http://cdnjs.com/libraries/highlight.js/ -->
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/styles/tomorrow.min.css">

    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/highlight.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/languages/javascript.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/languages/json.min.js"></script>
    <script>
    hljs.initHighlightingOnLoad();
    </script>


  	<style>


/*
 * Base structure
 */

/* Move down content because we have a fixed navbar that is 50px tall */
body {
  padding-top: 50px;
}


/*
 * Global add-ons
 */

.sub-header {
  padding-bottom: 10px;
  border-bottom: 1px solid #eee;
}

/*
 * Top navigation
 * Hide default border to remove 1px line.
 */
.navbar-fixed-top {
  border: 0;
}

/*
 * Sidebar
 */

/* Hide for mobile, show later */
.sidebar {
  display: none;
}
@media (min-width: 768px) {
  .sidebar {
    position: fixed;
    top: 51px;
    bottom: 0;
    left: 0;
    z-index: 1000;
    display: block;
    padding: 20px;
    overflow-x: hidden;
    overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
    /*background-color: #f5f5f5;*/
    border-right: 1px solid #eee;
  }
}

/* Sidebar navigation */
.nav-sidebar {
  margin-right: -21px; /* 20px padding + 1px border */
  margin-bottom: 20px;
  margin-left: -20px;
}
.nav-sidebar > li > a {
  padding-right: 20px;
  padding-left: 20px;
}
.nav-sidebar > .active > a,
.nav-sidebar > .active > a:hover,
.nav-sidebar > .active > a:focus {
  color: #fff;
  background-color: #428bca;
}


/*
 * Main content
 */

.main {
  padding: 20px;
}
@media (min-width: 768px) {
  .main {
    padding-right: 40px;
    padding-left: 40px;
  }
}
.main .page-header {
  margin-top: 0;
}



  	</style>
  </head>
  <body>

    <!-- Static navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/index.html">
		        <img style="max-width:100px; margin-top: -7px;"
		             src="http://www.amida-tech.com/assets/img/design/logo-retina.png">

		             &nbsp; Developers</a>

        </div>
        <!--div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/model.html">Data Model</a></li>
            <li><a href="/parsers.html">Parsers</a></li>
            <li><a href="/apis.html">APIs</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="../navbar-fixed-top/"> smth </a></li>
          </ul>
        </div--><!--/.nav-collapse -->
      </div>
    </div>


    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">

                    
          <h3>Blue Button (JSON) Data Model </h3>
                      
          <ul class="nav nav-sidebar">
                      
          </ul>

        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

<h2 id="library-interfaces-apis">Library interfaces/APIs</h2>
<p>This library provides following functionality</p>
<ul>
<li>Parse XML documents (via libxmljs)</li>
<li>Sense type of data (e.g. CCDA, C32, etc)</li>
<li>Parse CCDA into JSON representation<ul>
<li>Parse CCDA elements (sections) into JSON representation</li>
</ul>
</li>
<li>Generating JSON object based on data model</li>
</ul>
<h3 id="usage-example">Usage example</h3>
<p>Require blue-button module</p>
<pre><code class="lang-javascript">var bb = require(&quot;blue-button&quot;)
</code></pre>
<h3 id="parsexml-">parseXml()</h3>
<p>Load some XML and parse it</p>
<pre><code class="lang-javascript">var data = &quot;some CCDA.xml data here...&quot;;

//parse xml into JS object
var doc = bb.parseXml(data);
</code></pre>
<p>Check XML parsing errors</p>
<pre><code class="lang-javascript">console.log(doc.errors);
</code></pre>
<p>should be:</p>
<pre><code class="lang-javascript">[]
</code></pre>
<p>here is XML itself:</p>
<pre><code class="lang-javascript">console.log(doc.toString());
</code></pre>
<p>should be:</p>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;
&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;CDA.xsl&quot;?&gt;
&lt;!-- Title: US_Realm_Header_Template --&gt;
&lt;ClinicalDocument xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;urn:hl7-org:v3&quot; xmlns:cda=&quot;urn:hl7-org:v3&quot; xmlns:sdtc=&quot;urn:hl7-org:sdtc&quot;&gt;
  &lt;!-- ******************************************************** CDA Header 
        ******************************************************** --&gt;
  &lt;realmCode code=&quot;US&quot;/&gt;
  &lt;typeId root=&quot;2.16.840.1.113883.1.3&quot; extension=&quot;POCD_HD000040&quot;/&gt;
  &lt;!-- US General Header Template --&gt;
  &lt;templateId root=&quot;2.16.840.1.113883.10.20.22.1.1&quot;/&gt;
  &lt;!-- *** Note: The next templateId, code and title will differ depending 
        on what type of document is being sent. *** --&gt;
  &lt;!-- conforms to the document specific requirements --&gt;
  &lt;templateId root=&quot;2.16.840.1.113883.10.20.22.1.2&quot;/&gt;

  ...and so on
</code></pre>
<h3 id="sensexml-">senseXml()</h3>
<p>Let&#39;s sense document type from parsed XML:</p>
<pre><code class="lang-javascript">//get document type (e.g. CCDA) of parsed document
var type = bb.senseXml(doc);

console.log(type);
</code></pre>
<p>getting:</p>
<pre><code class="lang-javascript">{ type: &#39;ccda&#39; }
</code></pre>
<h3 id="sensestring-">senseString()</h3>
<p>Let&#39;s sense document type from string with health data:</p>
<pre><code class="lang-javascript">//get document type (e.g. CCDA) of document from string (and return parsed xml if it is xml based type)
var result = bb.senseString(data);

//printing result:
console.log(result);
</code></pre>
<p>getting type as well as parsed XML for later user:</p>
<pre><code class="lang-javascript">{ type: &#39;ccda&#39;, xml: { errors: [] } }
//xml &quot;errors&quot; is just default print of libxmljs parsed XML object

//in case of JSON stringified input, it will return {type: &#39;json&#39;, json: [json object here]}
</code></pre>
<p>Sensing CMS Blue Button data in text file:</p>
<pre><code class="lang-javascript">//get document type (e.g. CMS) of document from string (and return format version)
var result = bb.senseString(data);

//printing result:
console.log(result);
</code></pre>
<p>getting:</p>
<pre><code class="lang-javascript">{ type: &#39;cms&#39;, version: &#39;2.0&#39; }
</code></pre>
<p>getting type as well as parsed XML for later user:</p>
<pre><code class="lang-javascript">
{ type: &#39;ccda&#39;, xml: { errors: [] } }
//xml &quot;errors&quot; is just default print of libxmljs parsed XML object

//in case of JSON stringified input, it will return {type: &#39;json&#39;, json: [json object here]}
</code></pre>
<h3 id="parsetext-">parseText()</h3>
<p>Parsing into JSON data model from CMS text file</p>
<pre><code class="lang-javascript">//read in the file
var textString = fs.readFileSync(&quot;cms_sample.txt&quot;).toString(); 

//convert the string text file into blue button model
var result = bb.parseText(textString); 

console.log(result);
</code></pre>
<p>getting:</p>
<pre><code class="lang-javascript">
{ data: 
   { demographics: 
      { name: [Object],
        dob: [Object],
        email: [Object],
        phone: [Object],
        address: [Object] },
     vitals: [ [Object], [Object] ],
     results: [ [Object] ],
     medications: [ [Object], [Object] ],
     allergies: [ [Object], [Object] ],
     immunizations: [ [Object], [Object], [Object] ],
     problems: [ [Object], [Object] ],
     insurance: [ [Object], [Object], [Object], [Object], [Object], [Object] ],
     claims: [ [Object], [Object], [Object], [Object], [Object] ] },
  meta: 
   { type: &#39;cms&#39;,
     version: &#39;2.0&#39;,
     timestamp: { date: &#39;2013-03-16T05:10:00Z&#39;, precision: &#39;minute&#39; } } }
</code></pre>
<p>Parsing into JSON data model from XML or from string</p>
<pre><code class="lang-javascript">//convert Xml document into JSON
var result = bb.parseXml(doc);

//convert string into JSON
var result = bb.parseString(data);

console.log(result);
</code></pre>
<p>getting:</p>
<pre><code class="lang-javascript">{ data: 
   { demographics: 
      { name: [Object],
        dob: [Object],
        ...
        birthplace: [Object],
        guardians: [Object] },
     vitals: [ [Object], [Object], [Object], [Object], [Object], [Object] ],
     results: [ [Object] ],
     medications: [ [Object] ],
     encounters: [ [Object] ],
     allergies: [ [Object], [Object], [Object] ],
     immunizations: [ [Object], [Object], [Object], [Object] ],
     socialHistory: [ [Object] ],
     problems: [ [Object], [Object] ],
     procedures: [ [Object], [Object], [Object] ] },
  meta: { version: &#39;0.0.4&#39; },
  errors: 
   [ &#39;nullFlavor alert:  missing but required streetLines in Address -&gt; Patient -&gt; CCD&#39;,
     &#39;nullFlavor alert:  missing but required value in PhysicalQuantity -&gt; MedicationAdministration -&gt; Prescription -&gt; MedicationsSection -&gt; CCD&#39;
     ] }
</code></pre>
<p>Also, see <a href="./example">/example</a> for example above as well as how to parse individual sections.</p>

        </div>
      </div>
    </div>


    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<!-- Latest compiled and minified JavaScript -->
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
</html>